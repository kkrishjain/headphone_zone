<div class="v-stack gap-6 sm:gap-8">
    <h1 class="h2 text-center">How can we help you today?</h1><form class="main-search-form" action="/search" method="get" role="search">
    <div class="v-stack gap-6 sm:gap-12">
      <div class="search-input"  aria-controls="page-search-drawer">
        <input type="search" name="q" value="" placeholder="Search for..." autocomplete="off" autocorrect="off" spellcheck="false" aria-label="Search">
        <button type="submit">
          <svg role="presentation" stroke-width="1.5" focusable="false" width="22" height="22" class="icon icon-search" viewBox="0 0 22 22">
            <circle cx="11" cy="10" r="7" fill="none" stroke="currentColor"></circle>
            <path d="m16 15 3 3" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
        </button>
      </div>
    </div>
  </form>
</div>


<search-drawer  {% if request.design_mode %}handle-section-events{% endif %} class="search-drawer {% if section.settings.full_width %}search-drawer--full{% endif %} drawer drawer--lg" id="page-search-drawer">
  <form action="{{ routes.search_url }}" method="get" class="v-stack gap-5 sm:gap-8" role="search">
    <div class="search-input">
      <input type="search" name="q" placeholder="{{ 'search.general.search_placeholder' | t }}" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" aria-label="{{ 'search.general.title' | t | escape }}">
      <button type="reset" class="text-subdued">{{ 'search.general.clear' | t }}</button>
      <button type="button" is="close-button">
        <span class="sr-only">{{ 'general.accessibility.close' | t }}</span>
        {%- render 'icon' with 'close' -%}
      </button>
    </div>

    <style>
      #shopify-section-{{ section.id }} {
        --predictive-search-column-count: 3;
      }
    </style>

    <input type="hidden" name="type" value="page">

    <predictive-search class="predictive-search" section-id="{{ section.id }}">
      {%- if section.settings.search_menu.links.size > 0 -%}
        <div slot="idle">
          <div class="v-stack gap-3 sm:gap-4">
            {%- if section.settings.search_menu_show_title -%}
              <p class="bold text-subdued">{{ section.settings.search_menu.title }}</p>
            {%- endif -%}

            <ul class="v-stack gap-2 sm:gap-3" role="list">
              {%- for link in section.settings.search_menu.links -%}
                <li>
                  <a href="{{ link.url }}" class="h5">
                    <span class="reversed-link hover:show">{{ link.title }}</span>
                  </a>
                </li>
              {%- endfor -%}
            </ul>
          </div>
        </div>
      {%- endif -%}

      <div slot="results">
        {%- if predictive_search.performed -%}
          {%- assign results_count = 0 -%}
          {%- assign categories_count = 0 -%}

          {%- for resource in predictive_search.resources -%}
            {%- assign results_count = results_count | plus: resource.last.size -%}

            {%- if resource.last.size > 0 -%}
              {%- assign categories_count = categories_count | plus: 1 -%}
            {%- endif -%}
          {%- endfor -%}

          {%- if results_count == 0 -%}
            <div class="empty-state">
              <p class="h6">{{ 'search.general.no_results' | t }}</p>
              <p>Looking for a product which we don't sell?<br> <a href="https://www.headphonezone.in/pages/request-a-product" style="color:#3c07ff;" target="_blank"><b>Request a Product</b> </a></p>
            </div>
          {%- else -%}
            <span class="sr-only" role="status">{{ 'search.results_count' | t: count: results_count, terms: predictive_search.terms }}</span>

            <x-tabs class="predictive-search__tabs">
              <template>
                <style>
                  [role="tablist"]::-webkit-scrollbar {display: none;}

                  :host {
                    --predictive-search-column-width: {% if categories_count > 2 %}0px{% else %}400px{% endif %};
                  }
                </style>

                <slot role="tablist" part="tab-list" name="title"></slot>
                <slot part="tab-panels" name="content"></slot>
              </template>

  
              {%- if predictive_search.resources.pages.size > 0 -%}
                <div class="predictive-search__tab-item" slot="title">
                  <button type="button" class="h5">{{- 'search.general.pages' | t -}}</button>
                </div>

                <div slot="content" class="predictive-search__tab-content v-stack gap-2 justify-start">
                  {%- render 'predictive-search-result-item' for predictive_search.resources.pages as item, type: 'page' -%}
                </div>
              {%- endif -%}
            </x-tabs>
          {%- endif -%}
        {%- elsif search.performed -%}
          {%- if search.results_count > 0 -%}
            <x-tabs class="predictive-search__tabs">
              <template>
                <style>
                  [role="tablist"]::-webkit-scrollbar {display: none;}

                  :host {
                    --predictive-search-column-width: {% if categories_count > 2 %}0px{% else %}400px{% endif %};
                  }
                </style>

                <slot role="tablist" part="tab-list" name="title"></slot>
                <slot part="tab-panels" name="content"></slot>
              </template>

              {%- assign product_results = search.results | where: 'object_type', 'product' | slice: 0, 10 -%}
              {%- assign article_results = search.results | where: 'object_type', 'article' | slice: 0, 10 -%}
              {%- assign page_results = search.results | where: 'object_type', 'page' | slice: 0, 10 -%}

              {%- if product_results.size > 0 -%}
                <div class="predictive-search__tab-item" slot="title">
                  <button type="button" class="h5">{{- 'search.general.products' | t -}}</button>
                </div>

                <div class="predictive-search__tab-content v-stack gap-4 sm:gap-6" slot="content">
                  {%- render 'predictive-search-result-item' for product_results as item, type: 'product' -%}
                </div>
              {%- endif -%}

              {%- if article_results.size > 0 -%}
                <div class="predictive-search__tab-item" slot="title">
                  <button type="button" class="h5">{{- 'search.general.posts' | t -}}</button>
                </div>

                <div class="predictive-search__tab-content v-stack gap-4 sm:gap-6" slot="content">
                  {%- render 'predictive-search-result-item' for article_results as item, type: 'article' -%}
                </div>
              {%- endif -%}

              {%- if page_results.size > 0 -%}
                <div class="predictive-search__tab-item" slot="title">
                  <button type="button" class="h5">{{- 'search.general.pages' | t -}}</button>
                </div>

                <div slot="content" class="predictive-search__tab-content v-stack gap-2 justify-start">
                  {%- render 'predictive-search-result-item' for page_results as item, type: 'page' -%}
                </div>
              {%- endif -%}
            </x-tabs>
          {%- endif -%}
        {%- endif -%}
      </div>

      <div slot="loading">
        <div class="v-stack gap-5 sm:gap-6 {% if section.settings.full_width %}md:hidden{% endif %}">
          <div class="h-stack gap-4 sm:gap-5">
            {%- for i in (1..3) -%}
              <span class="skeleton skeleton--tab"></span>
            {%- endfor -%}
          </div>

          <div class="v-stack gap-4 sm:gap-6">
            {%- for i in (1..4) -%}
              <div class="h-stack align-center gap-5 sm:gap-6">
                <span class="skeleton skeleton--thumbnail"></span>

                <div class="v-stack gap-3 w-full">
                  <span class="skeleton skeleton--text" style="--skeleton-text-width: 20%"></span>
                  <span class="skeleton skeleton--text" style="--skeleton-text-width: 80%"></span>
                  <span class="skeleton skeleton--text" style="--skeleton-text-width: 40%"></span>
                </div>
              </div>
            {%- endfor -%}
          </div>
        </div>

        {%- if section.settings.full_width -%}
          <div class="predictive-search__skeleton-full-width hidden">
            {%- for i in (1..3) -%}
              <div class="v-stack gap-8">
                <span class="skeleton skeleton--tab"></span>

                {%- for i in (1..4) -%}
                  <div class="h-stack align-center gap-5 sm:gap-6">
                    <span class="skeleton skeleton--thumbnail"></span>

                    <div class="v-stack gap-3 w-full">
                      <span class="skeleton skeleton--text" style="--skeleton-text-width: 20%"></span>
                      <span class="skeleton skeleton--text" style="--skeleton-text-width: 80%"></span>
                      <span class="skeleton skeleton--text" style="--skeleton-text-width: 40%"></span>
                    </div>
                  </div>
                {%- endfor -%}
              </div>
            {%- endfor -%}
          </div>
        {%- endif -%}
      </div>
    </predictive-search>
  </form>
</search-drawer>
{% schema %}
{
  "name": "Search",
  "presets": [
    {
      "name": "page-search",
      "category": "Custom"
    }
    ],
  "class": "shopify-section--main-search",
  "tag": "section",
  "settings": [
      {
      "type": "range",
      "id": "products_per_page",
      "label": "Products per page",
      "min": 8,
      "max": 50,
      "step": 1,
      "default": 24
    },
    {
      "type": "select",
      "id": "products_per_row_mobile",
      "label": "Products per row (mobile)",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        }
      ],
      "default": "2"
    },
    {
      "type": "range",
      "min": 2,
      "max": 5,
      "id": "products_per_row_desktop",
      "label": "Products per row (desktop)",
      "info": "For best results, limit to 4 when using sidebar filtering. On small screen size, products per row is limited to 2 (with sidebar) or 3 (without sidebar) to maximize readability",
      "default": 3
    },
    {
      "type": "header",
      "content": "Filters & sort"
    },
    {
      "type": "select",
      "id": "filter_layout",
      "label": "Desktop layout",
      "options": [
        {
          "value": "sidebar",
          "label": "Sidebar"
        },
        {
          "value": "horizontal",
          "label": "Horizontal"
        },
        {
          "value": "drawer",
          "label": "Drawer"
        }
      ],
      "default": "sidebar"
    },
    {
      "type": "checkbox",
      "id": "show_sort_by",
      "label": "Show sort by",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_filters",
      "label": "Show filters",
      "info": "[Customize filters](/admin/menus)",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_filter_group_name",
      "label": "Show group name",
      "info": "Group name will be shown inside selected filters.",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_color_swatch",
      "label": "Show filter color swatch",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_empty_filter_values",
      "label": "Show empty filter values",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_filter_values_count",
      "label": "Show filter values count",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "open_first_filter_group",
      "label": "Open first group by default",
      "default": false
    }
  ]
}
{% endschema %}